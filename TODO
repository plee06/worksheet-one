TODO:

Finish up refactoring the code 